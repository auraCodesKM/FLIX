{%extends 'base_home.html'%}
{%block head%}
<title>FLIX - Discover Movies</title>
{%endblock%}

{%block body%}
<header>
    <div class="logo">FLIX</div>
    <div class="nav-toggle">
        <span></span>
        <span></span>
        <span></span>
    </div>
    <form action="{{ url_for('search') }}" method="get" class="search-form">
        {{ search_form.hidden_tag() }}
        {{ search_form.search_query(class="search-input", placeholder="Search movies...") }}
    </form>
    <nav>
        <a href="{{ url_for('home') }}">Discover</a>
        <a href="{{ url_for('my_ratings') }}">My Ratings</a>
        <a href="{{ url_for('logout') }}">Sign Out</a>
    </nav>
</header>

<main>
    <section class="movies">
        <h2>Popular Movies</h2>
        <div class="movie-list">
            {% for movie in movies %}
            <div class="movie" onclick=window.location.href='{{ url_for("movie_detail", movie_id=movie.id) }}'>
                <div class="movie-poster">
                    <img src="{{ movie.image_url }}" alt="{{ movie.title }}">
                    {% if movie.ratings %}
                    <div class="movie-rating">
                        <span class="rating-value">{{ "%.1f"|format(movie.ratings|map(attribute='rating')|sum / movie.ratings|length) }}</span>
                    </div>
                    {% endif %}
                </div>
                <div class="movie-info">
                    <h3>{{ movie.title }}</h3>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
</main>

<footer>
    <p>&copy; 2025 IMDb Clone. All Rights Reserved.</p>
</footer>

<script>
    document.querySelector('.nav-toggle').addEventListener('click', function() {
        document.querySelector('nav').classList.toggle('active');
    });
</script>
{%endblock%}